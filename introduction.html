<!doctypehtml><html class="sidebar-visible no-js light"lang=en><head><meta charset=UTF-8><title>Introduction - CLI text processing with GNU sed</title><meta content="text/html; charset=utf-8"http-equiv=Content-Type><meta content="Example based guide to mastering GNU sed"name=description><meta content=width=device-width,initial-scale=1 name=viewport><meta content=#ffffff name=theme-color><meta content="CLI text processing with GNU sed"property=og:title><meta content=website property=og:type><meta content="Example based guide to mastering GNU sed"property=og:description><meta content=https://learnbyexample.github.io/learn_gnused/ property=og:url><meta content=https://raw.githubusercontent.com/learnbyexample/learn_gnused/master/images/sed_ls.png property=og:image><meta content=1280 property=og:image:width><meta content=720 property=og:image:height><meta content=summary_large_image property=twitter:card><meta content=@learn_byexample property=twitter:site><link href=favicon.svg rel=icon><link rel="shortcut icon"href=favicon.png><link href=css/variables.css rel=stylesheet><link href=css/general.css rel=stylesheet><link href=css/chrome.css rel=stylesheet><link href=FontAwesome/css/font-awesome.css rel=stylesheet><link href=fonts/fonts.css rel=stylesheet><link href=highlight.css rel=stylesheet><link href=tomorrow-night.css rel=stylesheet><link href=ayu-highlight.css rel=stylesheet><link href=style.css rel=stylesheet><body><script>var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";</script><script>try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }</script><script>var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');</script><script>var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);</script><nav aria-label="Table of contents"class=sidebar id=sidebar><div class=sidebar-scrollbox><ol class=chapter><li class="chapter-item expanded affix"><a href=cover.html>Cover</a><li class="chapter-item expanded affix"><a href=buy.html>Buy PDF/EPUB versions</a><li class="chapter-item expanded"><a href=preface.html><strong aria-hidden=true>1.</strong> Preface</a><li class="chapter-item expanded"><a class=active href=introduction.html><strong aria-hidden=true>2.</strong> Introduction</a><li class="chapter-item expanded"><a href=in-place-file-editing.html><strong aria-hidden=true>3.</strong> In-place file editing</a><li class="chapter-item expanded"><a href=selective-editing.html><strong aria-hidden=true>4.</strong> Selective editing</a><li class="chapter-item expanded"><a href=breere-regular-expressions.html><strong aria-hidden=true>5.</strong> BRE/ERE Regular Expressions</a><li class="chapter-item expanded"><a href=flags.html><strong aria-hidden=true>6.</strong> Flags</a><li class="chapter-item expanded"><a href=shell-substitutions.html><strong aria-hidden=true>7.</strong> Shell substitutions</a><li class="chapter-item expanded"><a href=z-s-and-f-command-line-options.html><strong aria-hidden=true>8.</strong> z, s and f command line options</a><li class="chapter-item expanded"><a href=append-change-insert.html><strong aria-hidden=true>9.</strong> append, change, insert</a><li class="chapter-item expanded"><a href=adding-content-from-file.html><strong aria-hidden=true>10.</strong> Adding content from file</a><li class="chapter-item expanded"><a href=control-structures.html><strong aria-hidden=true>11.</strong> Control structures</a><li class="chapter-item expanded"><a href=processing-lines-bounded-by-distinct-markers.html><strong aria-hidden=true>12.</strong> Processing lines bounded by distinct markers</a><li class="chapter-item expanded"><a href=gotchas-and-tricks.html><strong aria-hidden=true>13.</strong> Gotchas and Tricks</a><li class="chapter-item expanded"><a href=further-reading.html><strong aria-hidden=true>14.</strong> Further Reading</a><li class="chapter-item expanded"><a href=Exercise_solutions.html><strong aria-hidden=true>15.</strong> Exercise Solutions</a></li><br><hr><li class="chapter-item expanded"><i class="fa fa-github"id=git-repository-button></i><a href=https://github.com/learnbyexample/learn_gnused>   Source code</a><li class="chapter-item expanded"><i class="fa fa-home"id=home-button></i><a href=https://learnbyexample.github.io/>   My Blog</a><li class="chapter-item expanded"><i class="fa fa-book"id=book-button></i><a href=https://learnbyexample.github.io/books/>   My Books</a><li class="chapter-item expanded"><i class="fa fa-envelope"id=mail-button></i><a href=https://learnbyexample.gumroad.com/l/learnbyexample-weekly>   learnbyexample weekly</a><li class="chapter-item expanded"><i class="fa fa-twitter"id=twitter-button></i><a href=https://twitter.com/learn_byexample>   Twitter</a></ol></div><div class=sidebar-resize-handle id=sidebar-resize-handle></div></nav><div class=page-wrapper id=page-wrapper><div class=page><div id=menu-bar-hover-placeholder></div><div class="menu-bar sticky bordered"id=menu-bar><div class=left-buttons><button aria-label="Toggle Table of Contents"title="Toggle Table of Contents"aria-controls=sidebar class=icon-button id=sidebar-toggle type=button><i class="fa fa-bars"></i></button><button aria-label="Change theme"title="Change theme"aria-controls=theme-list aria-expanded=false aria-haspopup=true class=icon-button id=theme-toggle type=button><i class="fa fa-paint-brush"></i></button><ul aria-label=Themes class=theme-popup id=theme-list role=menu><li role=none><button class=theme id=light role=menuitem>Light (default)</button><li role=none><button class=theme id=rust role=menuitem>Rust</button><li role=none><button class=theme id=coal role=menuitem>Coal</button><li role=none><button class=theme id=navy role=menuitem>Navy</button><li role=none><button class=theme id=ayu role=menuitem>Ayu</button></ul><button aria-label="Toggle Searchbar"title="Search. (Shortkey: s)"aria-controls=searchbar aria-expanded=false aria-keyshortcuts=S class=icon-button id=search-toggle type=button><i class="fa fa-search"></i></button></div><h1 class=menu-title>CLI text processing with GNU sed</h1><div class=right-buttons><a aria-label=Blog href=https://learnbyexample.github.io title=Blog> <i class="fa fa-home"id=home-button></i> </a><a aria-label=Twitter href=https://twitter.com/learn_byexample title=Twitter> <i class="fa fa-twitter"id=twitter-button></i> </a><a aria-label="Git repository"title="Git repository"href=https://github.com/learnbyexample/learn_gnused> <i class="fa fa-github"id=git-repository-button></i> </a></div></div><div class=hidden id=search-wrapper><form class=searchbar-outer id=searchbar-outer><input placeholder="Search this book ..."aria-controls=searchresults-outer aria-describedby=searchresults-header id=searchbar name=searchbar type=search></form><div class="searchresults-outer hidden"id=searchresults-outer><div class=searchresults-header id=searchresults-header></div><ul id=searchresults></ul></div></div><script>document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });</script><div class=content id=content><main><div class=sidetoc><nav class=pagetoc></nav></div><h1 id=introduction><a class=header href=#introduction>Introduction</a></h1><p>The command name <code>sed</code> is derived from <strong>s</strong>tream <strong>ed</strong>itor. Here, stream refers to data being passed via shell pipes. Thus, the command's primary functionality is to act as a text editor for <strong>stdin</strong> data with <strong>stdout</strong> as the output target. It is now common to use <code>sed</code> on file inputs as well as in-place file editing.<p>This chapter will show how to install the latest <code>sed</code> version followed by details related to documentation. Then, you'll get an introduction to the <strong>substitute</strong> command, which is the most commonly used feature. The chapters to follow will add more details to the substitute command, discuss other commands and command line options. Cheatsheet, summary and exercises are also included at the end of these chapters.<h2 id=installation><a class=header href=#installation>Installation</a></h2><p>If you are on a Unix-like system, you will most likely have some version of <code>sed</code> already installed. This book is primarily about <code>GNU sed</code>. As there are syntax and feature differences between various implementations, make sure to use <code>GNU sed</code> to follow along the examples presented in this book.<p><code>GNU sed</code> is part of the <a href=https://www.gnu.org/manual/manual.html>text creation and manipulation</a> tools and comes by default on GNU/Linux distributions. To install a particular version, visit <a href=https://www.gnu.org/software/sed/>gnu: sed software</a>. See also <a href=https://savannah.gnu.org/news/?group=sed>release notes</a> for an overview of changes between versions and <a href=https://debbugs.gnu.org/cgi/pkgreport.cgi?package=sed>bug list</a> if you think some command isn't working as expected.<pre><code class=language-bash>$ wget https://ftp.gnu.org/gnu/sed/sed-4.9.tar.xz
$ tar -Jxf sed-4.9.tar.xz
$ cd sed-4.9/
# see https://askubuntu.com/q/237576 if you get compiler not found error
$ ./configure
$ make
$ sudo make install

$ sed --version | head -n1
sed (GNU sed) 4.9
</code></pre><p>If you are not using a Linux distribution, you may be able to access <code>GNU sed</code> using an option below:<ul><li><a href=https://git-scm.com/downloads>Git for Windows</a> — provides a Bash emulation used to run Git from the command line<li><a href=https://en.wikipedia.org/wiki/Windows_Subsystem_for_Linux>Windows Subsystem for Linux</a> — compatibility layer for running Linux binary executables natively on Windows<li><a href=https://brew.sh/>brew</a> — Package Manager for macOS (or Linux)</ul><h2 id=documentation><a class=header href=#documentation>Documentation</a></h2><p>It is always good to know where to find documentation. From the command line, you can use <code>man sed</code> for a short manual and <code>info sed</code> for the full documentation. I prefer using the <a href=https://www.gnu.org/software/sed/manual/sed.html>online gnu sed manual</a>, which feels much easier to use and navigate.<pre><code class=language-bash>$ man sed
SED(1)                          User Commands                         SED(1)  

NAME
       sed - stream editor for filtering and transforming text

SYNOPSIS
       sed [-V] [--version] [--help] [-n] [--quiet] [--silent]
           [-l N] [--line-length=N] [-u] [--unbuffered]
           [-E] [-r] [--regexp-extended]
           [-e script] [--expression=script]
           [-f script-file] [--file=script-file]
           [script-if-no-other-script]
           [file...]

DESCRIPTION
       Sed  is  a  stream  editor.  A stream editor is used to perform basic
       text transformations on an input stream (a file or input from a pipe‐
       line).   While  in  some  ways  similar  to  an  editor which permits
       scripted edits (such as ed), sed works by making only one  pass  over
       the  input(s),  and  is consequently more efficient.  But it is sed's
       ability to filter text in a pipeline which particularly distinguishes
       it from other types of editors.
</code></pre><h2 id=options-overview><a class=header href=#options-overview>Options overview</a></h2><p>For a quick overview of all the available options, use <code>sed --help</code> from the command line.<pre><code class=language-bash># only partial output shown here
$ sed --help
  -n, --quiet, --silent
                 suppress automatic printing of pattern space
      --debug
                 annotate program execution
  -e script, --expression=script
                 add the script to the commands to be executed
  -f script-file, --file=script-file
                 add the contents of script-file to the commands to be executed
  --follow-symlinks
                 follow symlinks when processing in place
  -i[SUFFIX], --in-place[=SUFFIX]
                 edit files in place (makes backup if SUFFIX supplied)
  -l N, --line-length=N
                 specify the desired line-wrap length for the 'l' command
  --posix
                 disable all GNU extensions.
  -E, -r, --regexp-extended
                 use extended regular expressions in the script
                 (for portability use POSIX -E).
  -s, --separate
                 consider files as separate rather than as a single,
                 continuous long stream.
      --sandbox
                 operate in sandbox mode (disable e/r/w commands).
  -u, --unbuffered
                 load minimal amounts of data from the input files and flush
                 the output buffers more often
  -z, --null-data
                 separate lines by NUL characters
      --help     display this help and exit
      --version  output version information and exit

If no -e, --expression, -f, or --file option is given, then the first
non-option argument is taken as the sed script to interpret.  All
remaining arguments are names of input files; if no input files are
specified, then the standard input is read.
</code></pre><h2 id=editing-standard-input><a class=header href=#editing-standard-input>Editing standard input</a></h2><p><code>sed</code> has various commands to manipulate text. The <strong>substitute</strong> command is the most commonly used operation, which helps to replace matching portions with something else. The syntax is <code>s/REGEXP/REPLACEMENT/FLAGS</code> where:<ul><li><code>s</code> stands for the <strong>substitute</strong> command<li><code>/</code> is an idiomatic delimiter character to separate various portions of the command<li><code>REGEXP</code> stands for <strong>regular expression</strong><li><code>REPLACEMENT</code> refers to the replacement string<li><code>FLAGS</code> are options to change the default behavior of the command</ul><p>For now, it is enough to know that the <code>s</code> command is used for search and replace operations.<pre><code class=language-bash># input data that'll be passed to sed for editing
$ printf '1,2,3,4\na,b,c,d\n'
1,2,3,4
a,b,c,d

# for each input line, change only the first ',' to '-'
$ printf '1,2,3,4\na,b,c,d\n' | sed 's/,/-/'
1-2,3,4
a-b,c,d

# change all matches by adding the 'g' flag
$ printf '1,2,3,4\na,b,c,d\n' | sed 's/,/-/g'
1-2-3-4
a-b-c-d
</code></pre><p>In the above example, the input data is created using the <code>printf</code> command to showcase stream editing. By default, <code>sed</code> processes the input line by line. The newline character <code>\n</code> is the line separator by default. The first <code>sed</code> command replaces only the first occurrence of <code>,</code> with <code>-</code>. The second command replaces all occurrences as the <code>g</code> flag is also used (<code>g</code> stands for <code>global</code>).<blockquote><p><img alt=info src=images/info.svg> As a good practice, always use single quotes around the script argument. Examples requiring shell interpretation will be discussed later.</blockquote><blockquote><p><img alt=warning src=images/warning.svg> If your input file has <code>\r\n</code> (carriage return and newline characters) as the line ending, convert the input file to Unix-style before processing. See <a href=https://stackoverflow.com/q/45772525/4082052>stackoverflow: Why does my tool output overwrite itself and how do I fix it?</a> for a detailed discussion and mitigation methods.<pre><code class=language-bash># Unix style
$ printf '42\n' | file -
/dev/stdin: ASCII text

# DOS style
$ printf '42\r\n' | file -
/dev/stdin: ASCII text, with CRLF line terminators
</code></pre></blockquote><h2 id=editing-file-input><a class=header href=#editing-file-input>Editing file input</a></h2><p>Although <code>sed</code> derives its name from <em>stream editing</em>, it is common to use <code>sed</code> for file editing. To do so, you can pass one or more input filenames as arguments. You can use <code>-</code> to represent stdin as one of the input sources. By default, the modified data will go to the <code>stdout</code> stream and the input files are not modified. <a href=./in-place-file-editing.html#in-place-file-editing>In-place file editing</a> chapter will discuss how to apply the changes back to the source files.<blockquote><p><img alt=info src=images/info.svg> The <a href=https://github.com/learnbyexample/learn_gnused/tree/master/example_files>example_files</a> directory has all the files used in the examples.</blockquote><pre><code class=language-bash>$ cat greeting.txt
Hi there
Have a nice day

# for each line, change the first occurrence of 'day' with 'weekend'
$ sed 's/day/weekend/' greeting.txt
Hi there
Have a nice weekend

# change all occurrences of 'e' to 'E'
# redirect the modified data to another file
$ sed 's/e/E/g' greeting.txt > out.txt
$ cat out.txt
Hi thErE
HavE a nicE day
</code></pre><p>In the previously seen examples, every input line had matched the search expression. The first <code>sed</code> command here searched for <code>day</code>, which did not match the first line of <code>greeting.txt</code> file. By default, even if a line doesn't satisfy the search expression, it will be part of the output. You'll see how to get only the modified lines in the <a href=./selective-editing.html#print-command>Print command</a> section.<h2 id=cheatsheet-and-summary><a class=header href=#cheatsheet-and-summary>Cheatsheet and summary</a></h2><div class=table-wrapper><table><thead><tr><th>Note<th>Description<tbody><tr><td><code>man sed</code><td>brief manual<tr><td><code>sed --help</code><td>brief description of all the command line options<tr><td><code>info sed</code><td>comprehensive manual<tr><td><a href=https://www.gnu.org/software/sed/manual/sed.html>online gnu sed manual</a><td>well formatted, easier to read and navigate<tr><td><code>s/REGEXP/REPLACEMENT/FLAGS</code><td>syntax for the substitute command<tr><td><code>sed 's/,/-/'</code><td>for each line, replace the first <code>,</code> with <code>-</code><tr><td><code>sed 's/,/-/g'</code><td>replace all <code>,</code> with <code>-</code></table></div><p>This introductory chapter covered installation process, documentation and how to search and replace text using <code>sed</code> from the command line. In the coming chapters, you'll learn many more commands and features that make <code>sed</code> an important tool when it comes to command line text processing. One such feature is editing files in-place, which will be discussed in the next chapter.<h2 id=interactive-exercises><a class=header href=#interactive-exercises>Interactive exercises</a></h2><p>I wrote a TUI app to help you solve some of the exercises from this book interactively. See <a href=https://github.com/learnbyexample/TUI-apps/tree/main/SedExercises>SedExercises</a> repo for installation steps and <a href=https://github.com/learnbyexample/TUI-apps/blob/main/SedExercises/app_guide.md>app_guide.md</a> for instructions on using this app.<p>Here's a sample screenshot:<p align=center><img alt="SedExercises example"src=images/sed_exercises.png><h2 id=exercises><a class=header href=#exercises>Exercises</a></h2><blockquote><p><img alt=info src=images/info.svg> All the exercises are also collated together in one place at <a href=https://github.com/learnbyexample/learn_gnused/blob/master/exercises/Exercises.md>Exercises.md</a>. For solutions, see <a href=https://github.com/learnbyexample/learn_gnused/blob/master/exercises/Exercise_solutions.md>Exercise_solutions.md</a>.</blockquote><blockquote><p><img alt=info src=images/info.svg> The <a href=https://github.com/learnbyexample/learn_gnused/tree/master/exercises>exercises</a> directory has all the files used in this section.</blockquote><p><strong>1)</strong> Replace only the first occurrence of <code>5</code> with <code>five</code> for the given stdin source.<pre><code class=language-bash>$ echo 'They ate 5 apples and 5 mangoes' | sed ##### add your solution here
They ate five apples and 5 mangoes
</code></pre><p><strong>2)</strong> Replace all occurrences of <code>5</code> with <code>five</code>.<pre><code class=language-bash>$ echo 'They ate 5 apples and 5 mangoes' | sed ##### add your solution here
They ate five apples and five mangoes
</code></pre><p><strong>3)</strong> Replace all occurrences of <code>0xA0</code> with <code>0x50</code> and <code>0xFF</code> with <code>0x7F</code> for the given input file.<pre><code class=language-bash>$ cat hex.txt
start address: 0xA0, func1 address: 0xA0
end address: 0xFF, func2 address: 0xB0

$ sed ##### add your solution here
start address: 0x50, func1 address: 0x50
end address: 0x7F, func2 address: 0xB0
</code></pre><p><strong>4)</strong> The substitute command searches and replaces sequences of characters. When you need to map one or more characters with another set of corresponding characters, you can use the <code>y</code> command. Quoting from the manual:<blockquote><p><strong>y/src/dst/</strong> Transliterate any characters in the pattern space which match any of the source-chars with the corresponding character in dest-chars.</blockquote><p>Use the <code>y</code> command to transform the given input string to get the output string as shown below.<pre><code class=language-bash>$ echo 'goal new user sit eat dinner' | sed ##### add your solution here
gOAl nEw UsEr sIt EAt dInnEr
</code></pre><p><strong>5)</strong> Why does the following command produce an error? How'd you fix it?<pre><code class=language-bash>$ echo 'a sunny day' | sed s/sunny day/cloudy day/
sed: -e expression #1, char 7: unterminated `s' command

# expected output
$ echo 'a sunny day' | sed ##### add your solution here
a cloudy day
</code></pre></main><nav aria-label="Page navigation"class=nav-wrapper><a aria-label="Previous chapter"class="mobile-nav-chapters previous"title="Previous chapter"aria-keyshortcuts=Left href=preface.html rel=prev> <i class="fa fa-angle-left"></i> </a><a aria-label="Next chapter"class="mobile-nav-chapters next"title="Next chapter"aria-keyshortcuts=Right href=in-place-file-editing.html rel=next> <i class="fa fa-angle-right"></i> </a><div style="clear: both"></div></nav></div></div><nav aria-label="Page navigation"class=nav-wide-wrapper><a aria-label="Previous chapter"class="nav-chapters previous"title="Previous chapter"aria-keyshortcuts=Left href=preface.html rel=prev> <i class="fa fa-angle-left"></i> </a><a aria-label="Next chapter"class="nav-chapters next"title="Next chapter"aria-keyshortcuts=Right href=in-place-file-editing.html rel=next> <i class="fa fa-angle-right"></i> </a></nav></div><script>window.playground_copyable = true;</script><script charset=utf-8 src=elasticlunr.min.js></script><script charset=utf-8 src=mark.min.js></script><script charset=utf-8 src=searcher.js></script><script charset=utf-8 src=clipboard.min.js></script><script charset=utf-8 src=highlight.js></script><script charset=utf-8 src=book.js></script><script src=sidebar.js></script>